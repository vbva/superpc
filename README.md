# Конкурсное задание по суперкомпьютерной практике

Тьюторы: И.Н.Коньшин и А.А.Лёгкий
Команда: D (группа 1М-ММ)

# Формулировка задачи диффузии

Рассматривается решением нестационарного уравнения диффузии с неизвестной
U = U(x, y, z, t):

```
∂U/∂t − ∇(D · gradU) = f(x, y, z, t)
```

где точка (x, y, z) принадлежит Ω = [0; 1]<sup>3</sup>
, а время t рассматривается
на отрезке [0; T]. Граничные условия: U(x, y, z, t) = g(x, y, z) на границе
области ∂Ω, а начальные условия: U(x, y, z, 0) = 0 в начальный момент
времени t<sub>0</sub> = 0. Конечный момент времени T = 1.

Будем использовать диагональный тензор D:

D = [[d<sub>x</sub>, 0, 0], [0, d<sub>y</sub>, 0], [0, 0, d<sub>z</sub>]]

где d<sub>x</sub> = 0.25, d<sub>y</sub> = 0.15, d<sub>z</sub> = 0.1. Зададим также начально-краевые условия:

g(x, y, z) = 0,

f(x, y, z) = (d<sub>x</sub> + d<sub>y</sub> + d<sub>z</sub>) · π<sup>2</sup> · sin(πx) sin(πy) sin(πz).

Решаемое уравнения имеет аналитическое решение:

U<sup>∗</sup> = sin(πx) sin(πy) sin(πz) · (1 − exp(−(dx + dy + dz) · π<sup>2</sup>t)).

# Результаты

Реализована программа для одного процессора в ветке main/one proc

Реализована программа для параллельных процессоров в ветке mpi

Произведен запуск параллельной программы на разном количестве процессоров. Построен график зависимости от времени выполнения и график зависимости ускорения от количества процессоров (s - значение ускорения, p - количество процессоров, NX NY NZ - размерность сетки)

<img src="./results/time1.png">
<img src="./results/grid1.png">
<img src="./results/grid2.png">
<img src="./results/time2.png">

<!-- # Дискретизация

Построим в нашей области Ω равномерную сетку, состоящую из параллелепипедов.
Пусть нам заданы количества ячеек N<sub>x</sub>, N<sub>y</sub> и N<sub>z</sub> вдоль каждого из направлений
O<sub>x</sub>, O<sub>y</sub> и O<sub>z</sub>, соответственно.

При этом количество узлов вдоль каждого из направлений будет равно N<sub>x</sub> + 1, N<sub>y</sub> + 1 и N<sub>z</sub> + 1, а шаги сетки будет
равны ∆x = 1/N<sub>x</sub>, ∆y = 1/N<sub>y</sub> и ∆z = 1/N<sub>z</sub>, соответственно.

Обозначим через V<sub>ijk</sub> узел сетки с координатами x<sub>i</sub> = i ∆x, y<sub>j</sub> = j ∆y и z<sub>k</sub> = k ∆z.

Будем описывать дискретную функцию [U]<sup>h</sup> в момент времени n∆t её степенями свободы, которые расположим в узлах сетки, а степень свободы в узле V<sub>ijk</sub> обозначим через U<sup>n</sup><sub>ijk</sub>, 0 ⩽ i ⩽ Nx, 0 ⩽ j ⩽ Ny и 0 ⩽ k ⩽ Nz.

Дискретизуем наше уравнение по пространству методом конечных разностей, а по времени явной схемой Эйлера. Заметим, что для такой дискретизации шаг по времени должен удовлетворять условию Куранта:
∆t < τ<sup>∗</sup> = &frac12;(d<sub>x</sub>/(∆x)<sup>2</sup> + d<sub>y</sub>/(∆y)<sup>2</sup> + d<sub>z</sub>/(∆z)<sup>2</sup>)

Для определенности можно положить ∆t = 0.9τ<sup>∗</sup>

Введём дискретные операторы вторых пространственных производных:

L<sub>x,ijk</sub>U<sup>n</sup> = (U<sup>n</sup><sub>i−1,j,k</sub> − 2U<sup>n</sup><sub>i,j,k</sub>+ U<sup>n</sup><sub>i+1,j,k</sub>) / (∆x)<sup>2</sup>,

L<sub>y,ijk</sub>U<sup>n</sup> = (U<sup>n</sup><sub>i,j-1,k</sub> − 2U<sup>n</sup><sub>i,j,k</sub>+ U<sup>n</sup><sub>i,j+1,k</sub>) / (∆y)<sup>2</sup>,

L<sub>z,ijk</sub>U<sup>n</sup> = (U<sup>n</sup><sub>i,j,k-1</sub> − 2U<sup>n</sup><sub>i,j,k</sub>+ U<sup>n</sup><sub>i,j,k+1</sub>) / (∆z)<sup>2</sup>,

а также f<sup>n</sup><sub>i,j,k</sub> = f(i∆x, j∆y, k∆z, n∆t) и g<sub>i,j,k</sub> = g(i∆x, j∆y, k∆z).

В этих обозначениях во всех внутренних точках численная схема записывается следующим образом:

U<sup>n+1</sup><sub>i,j,k</sub> = U<sup>n</sup><sub>i,j,k</sub> + ∆t(f<sup>n</sup><sub>i,j,k</sub> + d<sub>x</sub>L<sub>x, ijk</sub>U<sup>n</sup> +
d<sub>y</sub>L<sub>y, ijk</sub>U<sup>n</sup> + d<sub>z</sub>L<sub>z, ijk</sub>U<sup>n</sup>)

т.е., если 1 ⩽ i ⩽ N<sub>x</sub>−1, 1 ⩽ j ⩽ N<sub>y</sub>−1, 1 ⩽ k ⩽ N<sub>z</sub> −1.
Во всех граничных точках значения остаются старыми (функция g от времени не зависит):

U<sup>n+1</sup><sub>i,j,k</sub> = g<sub>i,j,k</sub>,

т.е., если (i%N<sub>x</sub>) · (j%N<sub>y</sub>) · (k%N<sub>z</sub>) = 0 (это как раз и есть все граничные точки). Здесь a%b – операция взятия остатка от деления a на b (как это иделается в языках С и С++) -->
